<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê³ ì–‘ì´ ê°€ë¼ì‚¬ëŒ€</title>
  </head>
  <style>
    body {
      text-align: center;
    }
    .main-card button {
      position: relative;
      left: -45px;
      bottom: 15px;
    }
    .favorites {
      list-style: none;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
    }
  </style>
  <body>
    <div id="app"></div>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>      <!--//react ì½”ë“œ ì¶”ê°€-->
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>       <!--//reactDOM ì½”ë“œ ì¶”ê°€-->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>       <!--//babel ì½”ë“œ ì¶”ê°€ = ìƒˆë¡œìš´ ìœ í˜•ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¸Œë¼ìš°ì €ê°€ ì´í•´í•  ìˆ˜ ìˆë„ë¡ í†µì—­(ì»´íŒŒì¼)-->
    <script type="text/babel">
      const jsonLocalStorage = {
        // ê°’ì„ ì €ì¥í•  ë•Œ, JSON.stringify(value)ë¡œ ì…‹íŒ…
        setItem: (key, value) => {
          localStorage.setItem(key, JSON.stringify(value));
        },
        // ë°›ì•„ì˜¨ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ë°ì´í„°ë¥¼ Jsonìœ¼ë¡œ parseí•´ ê°€ì ¸ì˜´
        getItem: (key) => {
          return JSON.parse(localStorage.getItem(key));
        },
      };

      // Open APIë¡œ ê³ ì–‘ì´ì˜ ëœë¤ ì‚¬ì§„ì„ ë°›ì•„ì˜¤ëŠ” ë°©ë²•
      const fetchCat = async (text) => {
        const OPEN_API_DOMAIN = "https://cataas.com";   // Open API ì£¼ì†Œ
        const response = await fetch(`${OPEN_API_DOMAIN}/cat/says/${text}?json=true`);    // ì‘ë‹µê°’ì„ ë°›ì•„ì™€ response ë³€ìˆ˜ì— ë‹´ì•„ì£¼ê¸° >> ì‘ë‹µê°’ì„ ë°›ì•„ì˜¬ë•Œ, json í˜•ì‹ìœ¼ë¡œ ë°›ì•„ì˜¤ë„ë¡
        // https://joshua1988.github.io/web-development/javascript/js-async-await/#async--awaitëŠ”-ë­”ê°€ìš”
        const responseJson = await response.json();
        return `${OPEN_API_DOMAIN}/cat/${responseJson._id}/says/${text}`; // NOTE: API ìŠ¤í™ ë³€ê²½ìœ¼ë¡œ ê°•ì˜ ì˜ìƒê³¼ ë‹¤ë¥¸ URLë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.
      };

      console.log("ì•¼ì˜¹");

      const Title = ({counter}) => {
        if(counter===null){   // counterëŠ” ìˆ«ìíƒ€ì…ìœ¼ë¡œ, '' ì•ˆë¨¹ê³  nullë¡œ ì§€ì •
          return(
            <h2>ê³ ì–‘ì´ ê°€ë¼ì‹œëŒ€</h2>
          // <h2>{props.children}</h2> // .children : ì•„ë˜ "<Title>1ë²ˆì§¸ ê³ ì–‘ì´ ê°€ë¼ì‚¬ëŒ€<Title/>"ì—ì„œ ë°›ì•„ì˜¨ ì¸ìê°’ì„ propsê°€ ì–´ë–»ê²Œ ë°›ì•„ì˜¤ëŠ”ì§€ console.log(props)ë¡œ í™•ì¸ í–ˆì„ë•Œ, .childrenë¼ëŠ” í˜•íƒœë¡œ ê°’ì„ ë°›ì•„ì˜¤ëŠ” ê²ƒì„ í™•ì¸.  >>  í•˜ì—¬, {props.children}ë¡œ ì‘ì„±
        ) 
        } else{
          return(<h2>{counter}ë²ˆì§¸ ê³ ì–‘ì´ ê°€ë¼ì‚¬ëŒ€</h2>)
        }
      };

      const Form = ({updateMainCat}) => {
          // í•œê¸€ì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ trueë¥¼, í¬í•¨ë˜ì§€ ì•Šìœ¼ë©´ falseë¥¼ ë°˜í™˜
          const includesHangul = (text) => /[ã„±-ã…|ã…-ã…£|ê°€-í£]/i.test(text); // í¼ ê²€ì¦(form validation) ë¡œì§ => ì˜ì–´ë¡œ ì…ë ¥ë°›ì•„ì•¼ í•˜ëŠ”ë°, ì‚¬ìš©ìê°€ í•œê¸€ì„ ì…ë ¥í•œ í›„ í¼ ì œì¶œì„ í•œ ê²½ìš°

          const [value, setValue] = React.useState("");
          const [errorMessage, setErrorMessage] = React.useState("");

          function handleInputChange(e) {
            const userValue = e.target.value;
            setErrorMessage('');  // ê·¸ ì „ ê°’ì„ ì§€ìš°ê¸° ìœ„í•œ ì´ˆê¸°í™”ë¥¼ ì§„í–‰
            if (includesHangul(userValue)){
              setErrorMessage("í•œê¸€ì„ ì…ë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            }
            setValue(userValue.toUpperCase()); // eëŠ” ì´ë²¤íŠ¸ ê°ì²´ë¥¼ ë‚˜íƒ€ë„¤ë©° e.targetì€ í˜„ì¬ ë°œìƒí•œ ì´ë²¤íŠ¸ì˜ íƒ€ê²Ÿ, e.target.valueëŠ” í•´ë‹¹ íƒ€ê²Ÿì˜ value ì†ì„±ê°’ì„ ì˜ë¯¸. // .toUpperCase() : ì†Œë¬¸ìë¥¼ ëŒ€ë¬¸ìë¡œ ë³€í™˜
          }
          /*ë¹ˆ ê°’ìœ¼ë¡œ ì¬ì¶œí•  ê²½ìš°, ì—ëŸ¬ë©”ì„¸ì§€ë¥¼ ë„ì›€*/
          function handleFormSubmit(e){
            e.preventDefault(); // ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²•. ê¸°ë³¸ì ìœ¼ë¡œ í¼ ì œì¶œì„ í•˜ë©´, ë¸Œë¼ìš°ì €ê°€ ë¦¬í”„ë ˆì‹œ ë¨ >> ì´ë¥¼ ë°©ì§€. ì œì¶œ ì‹œ, ë¸Œë¼ìš°ì €ê°€ ë¦¬í”„ë ˆì‹œ í•˜ëŠ” ê²ƒì„ ë°©ì§€í•¨.
            setErrorMessage('');  // ê·¸ ì „ ê°’ì„ ì§€ìš°ê¸° ìœ„í•œ ì´ˆê¸°í™”ë¥¼ ì§„í–‰
            if (value == ''){
              setErrorMessage("ë¹ˆ ê°’ì€ ì…ë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
              return; // ë¹ˆ ê°’ìœ¼ë¡œ ì œì¶œí•  ê²½ìš°, updateMainCat()í•¨ìˆ˜ê°€ ì‘ë™í•˜ì§€ ì•Šë„ë¡(ë©”ì¸íƒ€ì´í‹€ì˜ në²ˆì§¸ ìˆ«ìê°€ ë°”ë€Œì§€ ì•Šë„ë¡) returnìœ¼ë¡œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ë¹ ì ¸ë‚˜ê°€ë„ë¡ ì‘ì„±
            }
            updateMainCat(value);
          }
        return (
          //ê¸°ë³¸ì ìœ¼ë¡œ í¼ ì œì¶œì„ í•˜ë©´, ë¸Œë¼ìš°ì €ê°€ ë¦¬í”„ë ˆì‹œ ë¨
          <form onSubmit={handleFormSubmit}>   
            <input 
                   type="text" 
                   name="name" 
                   placeholder="ì˜ì–´ ëŒ€ì‚¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"
                   value={value}  //const [value, setvalue] = React.uses(''); ìœ„ ì½”ë“œì—ì„œ ì •ì˜í•œ ë™ì ìœ¼ë¡œ ì‘ë™í•˜ëŠ” valueë¥¼ ì¸í’‹ì˜ ë°¸ë¥˜ê°’ìœ¼ë¡œ ì§€ì •
                   onChange={handleInputChange} //onChange : inputê°’ì´ ë°”ë€”ë•Œë§ˆë‹¤ {handleInputChange}í•¨ìˆ˜ë¥¼ í˜¸ì¶œ
            />
            <button type="submit">ìƒì„±</button>
            <p style={{color: "red"}}>{errorMessage}</p>
          </form>
        );
      };

      // Props >> Reactì—ì„œ ì¸ìë¥¼ ë„˜ê²¨ì¤€ ê²ƒì„ ì§€ì¹­
      function CatItem(props) {
        return(
        <li>
          <img 
              src= {props.img} 
              style={ {width: "150px"} } // ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ë§ ë°©ì‹. valueê°’ì„ string í˜•ì‹("")ìœ¼ë¡œ ì„¤ì •
          />
        </li>
        );
      }

      function Favorites({favorites}){
        // ì¡°ê±´ë¶€ ëœë”ë§ >> favoritesì— ì €ì¥ëœ ê°’ì´ ì—†ìœ¼ë©´ ë¬¸êµ¬ í‘œì‹œ
        if(favorites.length === 0){
          return <div>ì‚¬ì§„ ìœ„ í•˜íŠ¸ë¥¼ ëˆŒëŸ¬ ê³ ì–‘ì´ ì‚¬ì§„ì„ ì €ì¥í•´ë³´ì„¸ìš”!</div>;
        }
        return(
          // ë¦¬ì•¡íŠ¸ì—ì„œëŠ” classë¼ëŠ” ì†ì„± ëŒ€ì‹  class-nameì´ë¼ëŠ” ì†ì„±ì„ ì‚¬ìš©í•œë‹¤. í‘œê¸°ë²• : className. ì˜ˆì‹œ : (className="fav").
          <ul className="favorites">  
            {favorites.map((cat) => (
              <CatItem img={cat} key={cat} /> //ë§µì„ ì˜ í™œìš©í•˜ë ¤ë©´ í‚¤ê°’ì„ ì§€ì •í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤. ë³´í†µ ë³€ìˆ˜ì— ê°’ì„ ì§€ì •í•  ë•Œ(CAT1 ë“±) idê°’ì„ í•¨ê»˜ ì§€ì •í•¨. ì—¬ê¸°ì„œëŠ” url(cat)ì„ í‚¤ì´ì ê°’ìœ¼ë¡œ ì§€ì •í•œ ìƒíƒœì„
            ))}
          </ul>
        );
      }

      // í™”ì‚´í‘œ í•¨ìˆ˜ : í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜
      const MainCard = ({img, onHeartClick, alreadyFavorite}) => {
        // onCilckìœ¼ë¡œ ë°›ì•„ì£¼ëŠ” ì´ë²¤íŠ¸í•¸ë“¤ëŸ¬ëª…ì€ handle...Clickìœ¼ë¡œ ëª…ëª…í•œë‹¤
        // onMouseOverìœ¼ë¡œ ë°›ì•„ì£¼ëŠ” ì´ë²¤íŠ¸í•¸ë“¤ëŸ¬ëª…ì€ handle...MouseOverìœ¼ë¡œ ëª…ëª…í•œë‹¤
        const heartIcon = alreadyFavorite ? "ğŸ’–" : "ğŸ¤";
        return(
          <div className="main-card">
            <img
               src={img}
               alt="ê³ ì–‘ì´"
               width="400"
            />
            <button onClick={onHeartClick}>{heartIcon}</button> 
          </div>
        );
      };

      // mainCardì™€ favoritesë¥¼ ëª¨ë‘ renderí•˜ì—¬ í™ˆí˜ì´ì§€ì— ë³´ì—¬ì£¼ê³  ì‹¶ì€ë°, ëœë”ëŠ” í•˜ë‚˜ë§Œ í•  ìˆ˜ ìˆìŒ.
      // ë•Œë¬¸ì—, ë³€ìˆ˜ë¥¼ ë”°ë¡œ ìƒì„±í•´ ë‘ ë³€ìˆ˜ë¥¼ ê¸°ìˆ  
      // ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸
      // UIë¥¼ ìƒˆë¡œ ê·¸ë¦´ ë•Œë§ˆë‹¤ app ì»´í¬ë„ŒíŠ¸ ì•ˆì— ìˆëŠ” ëª¨ë“  ì½”ë“œë“¤ì´ ì „ë¶€ ë‹¤ì‹œ í˜¸ì¶œë¨
      const App = () => {
        const CAT1 = "https://cataas.com/cat/HSENVDU4ZMqy7KQ0/says/react";
        const CAT2 = "https://cataas.com/cat/BxqL2EjFmtxDkAm2/says/inflearn";
        const CAT3 = "https://cataas.com/cat/18MD6byVC1yKGpXp/says/JavaScript";
        // ìµœìƒìœ„ íƒœê·¸ê°€ 1ê°œì´ì—¬ì•¼ í•¨. ë•Œë¬¸ì— <div></div> ì•ˆì— {mainCard}ì™€ {favorites}ë¥¼ ê¸°ìˆ 
        //const [counter, setCounter] = React.useState(1); // ì•„ë˜ 3 ì½”ë“œë¥¼ ìë°”ë¬¸ë²•ì„ ì‚¬ìš©í•˜ì—¬ í•œ ì¤„ë¡œ ë‹¨ì¶• ê°€ëŠ¥
        /*const counterState = React.useState(1); //ì´ˆê¸°ê°’ì„ 1ë¡œ ì„¤ì •
        const counter = counterState[0]; // ì´ˆê¸°ê°’ì´ ì €ì¥ëœ ê³µê°„
        const setCounter = counterState[1]; // ë‹¤ìŒ ì¹´ìš´í„°ë¥¼ ì§€ì •í•˜ê¸° ìœ„í•œ ê³µê°„*/
        //const [counter, setCounter] = React.useState(Number(jsonLocalStorage.getItem('counter')));  // localStorageì— ê°’ì„ ì €ì¥í•˜ê²Œ ë˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ Stringê°’ìœ¼ë¡œ ì €ì¥í•¨. ì´ë¥¼ Number íƒ€ì…ìœ¼ë¡œ ì €ì¥ë  ìˆ˜ ìˆë„ë¡ ë³€í™˜í•´ì¤Œ
        const [counter, setCounter] = React.useState(() => { 
          return jsonLocalStorage.getItem("counter"); 
        });  // ìœ„ì—ì„œ ë¯¸ë¦¬ ì •ì˜í•œ jsonLocalStorage() ì˜ ë¡œí„¸ìŠ¤í† ë¦¬ì§€ í˜•ì‹ì„ ì‚¬ìš©
        const [mainCat, setmainCat] = React.useState(CAT1);
        const [favorites, setFavorites] = React.useState(() => {  // LocalStorageì— ì ‘ê·¼ ì‹œ, ë¶€í•˜ ì´ìŠˆê°€ ë°œìƒ. >> React.useState()ì•ˆì— í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ í•´ê²° ê°€ëŠ¥ >> ì•±ì´ ì‹¤í–‰ë  ë•Œ, ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë‹¨ í•œë²ˆë§Œ ì ‘ê·¼í•˜ê²Œ í•œ í›„, ë”ì´ìƒ ì ‘ê·¼í•˜ì§€ ì•Šë„ë¡ ë§Œë“œëŠ” ê²ƒ
          return jsonLocalStorage.getItem("favorites") || []; 
        }) ; // jsonLocalStorage.getItem("favorites")ë¡œ ì´ˆê¸°ê°’ì„ ì§€ì •. But, ê°’ì´ ì—†ìœ¼ë©´ || ì—°ì‚°ì ë’¤ì— ìˆëŠ” []ë°°ì—´(ë¹ˆ ë°°ì—´)ë¡œ ì´ˆê¸°ê°’ ì§€ì •í•˜ë¼.
        
        const  alreadyFavorite = favorites.includes(mainCat);     // .includes() : favorites ëª©ë¡ì— í¬í•¨ ì—¬ë¶€

        async function setInitialCat(){
        const newCat = await fetchCat("First cat");
        setmainCat(newCat);
        }

        // ë‹¨ë…ìœ¼ë¡œ setInitialCat();ë§Œ í˜¸ì¶œí•˜ëŠ” ë¡œì§ì„ ì“°ë©´, appì—ì„œ UIê°€ ê·¸ë ¤ì§ˆ ë•Œë§ˆë‹¤ ì‘ë™í•˜ê²Œ ë¨. >> ex. í¼ì„ ì œì¶œí•  ë•Œë§ˆë‹¤ firstCat ì´ë¯¸ì§€ê°€ ìƒì„±ë¨
        // ìš°ë¦¬ëŠ” ì²˜ìŒì— ë¸ŒëŸ¬ìš°ì €ì— ì ‘ì†í–ˆì„ë•Œ, ì²« ë©”ì¸ ì‚¬ì§„ë§Œ ì…‹íŒ…í•˜ë„ë¡ í• ê²ƒì„
        // ë•Œë¬¸ì— setInitialCat()ì€ ì´ˆê¸° 1ë²ˆë§Œ ì‹¤í–‰ì‹œí‚¤ê³ ì í•¨
        // ì´ë•Œ, ì‚¬ìš©í•´ì•¼í•˜ëŠ” ê²ƒì´ React.useEffect(). ì´ëŠ” UIê°€ ë°”ë€” ë•Œë§ˆë‹¤ê°€ ì•„ë‹Œ, ì›í•˜ëŠ” íŠ¹ì • ì‹œì ì—ì„œë§Œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ì‹¶ì„ë•Œ ì‚¬ìš©.
        // React.useEffectì˜ ë‘ë²ˆì§¸ ì¸ìë¡œ ë°°ì—´ì„ ë„˜ê¸°ê³ , ê±°ê¸°ì— ë‚´ê°€ ì›í•˜ëŠ” ìƒíƒœë¥¼ ë„˜ê²¨ì£¼ë©´ ë¨
        // ë§¨ ì²˜ìŒ ì•±ì´ ìƒì„±ë˜ì—ˆì„ ë•Œë§Œ ì–˜ë¥¼ í˜¸ì¶œí•˜ê³  ì‹¶ë‹¤ê³  í• ë•Œ, ë‘ë²ˆì§¸ ì¸ìì— ë¹ˆ ë°°ì—´ì„ ë„£ì–´ì£¼ë©´ ëœë‹¤
        React.useEffect(() => {
          setInitialCat();
        }, []);

        async function updateMainCat(value){
          const newCat = await fetchCat(value);

          setmainCat(newCat);

          setCounter((prev) => {  // prev : previousì˜ ì•½ì. ê¸°ì¡´ ê°’. setcountê°’ì„ ë³€ê²½í•˜ê¸° ì „ì˜ ê¸°ì¡´ê°’ì„ ì²« ë²ˆì§¸ ì¸ìë¡œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŒ.
            const nextCount = counter + 1;
            jsonLocalStorage.setItem("counter", nextCount);   // ë¸Œë¼ìš°ì € ìƒˆë¡œê³ ì¹¨ ì‹œ, ì´ì „ì˜ ë°ì´í„°ì •ë³´ê°€ ë‚ ë¼ê°€ê²Œ ë˜ëŠ”ë°, ì´ë¥¼ ë°©ì§€í•˜ê³ ì localStorage í•¨ìˆ˜ë¥¼ ì´ìš©. >> ë¸Œë¼ìš°ì €ì— key-value ê°’ì„ Storageì— ì €ì¥ ê°€ëŠ¥í•¨.
            return nextCount;
          })
       }

        function handleHeartClick({}){
          const nextFavorites = [...favorites, mainCat]  // ê¸°ì¡´ favorites ë°°ì—´ì— CAT3 ê°’ì„ ì¶”ê°€í•¨
          setFavorites(nextFavorites);
          jsonLocalStorage.setItem("favorites", nextFavorites);   // ë¸Œë¼ìš°ì €ë¥¼ ìƒˆë¡œ ê³ ì¹¨í•˜ë”ë¼ë„ ê¸°ì¡´ ë°ì´í„° ë‚¨ì•„ ìˆë„ë¡
        }

        return(
        <div>  
          <Title counter={counter} />
          <Form updateMainCat={updateMainCat} />
          <MainCard img={mainCat} onHeartClick={handleHeartClick} alreadyFavorite={alreadyFavorite}/>
          <Favorites favorites={favorites}/>
        </div>
      );
      };

      const ì—¬ê¸°ë‹¤ê°€ê·¸ë ¤ = document.querySelector("#app");
      ReactDOM.render(<App />, ì—¬ê¸°ë‹¤ê°€ê·¸ë ¤); // catitemì„ ReactDOMë¥¼ ì‚¬ìš©í•´ì„œ ì—¬ê¸°ë‹¤ê°€ê·¸ë ¤ì— ê·¸ë ¤ë¼


  
    </script>
  </body>
</html>



<!-- 
  1. Javascript ë¬¸ë²•ì„ ë¦¬ì•¡íŠ¸ ì•ˆì—ì„œ ì‚¬ìš©í•˜ê¸°
     >> ì¤‘ê´„í˜¸{} ì‚¬ìš©í•˜ê¸° 
  2. ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©í•˜ê¸° 
     >> < /> íƒœê·¸ ì‚¬ìš©í•˜ê¸° 
-->

<!-- 
* EE6+ ë””ìŠ¤íŠ¸ëŸ­ì²˜ë§ ë¬¸ë²• ì ìš© ì „

  const MainCard = (props) => (
    <img scr={props.img} />
  }


* EE6+ ë””ìŠ¤íŠ¸ëŸ­ì²˜ë§ ë¬¸ë²• ì ìš© í›„
  const MainCard = ({img}) => (
    <img scr={img} />
  } 
-->

